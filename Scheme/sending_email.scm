(define r-edge
  (lambda (G)
    (cond ((null? G) '())
          (#t (append (list (car G)) (list (append (list (cadar G)) (list (caar G)) (list (caddar G)))) (r-edge (cdr G)))))))

(define repeat-e
  (lambda (E N)
    (cond ((<= N 0) '())
          (#t (append (list E) (repeat-e E (- N 1)))))))

(define replace-at
  (lambda (L E N)
    (cond ((= N 0) (append (list E) (cdr L)))
          (#t (append (list (car L)) (replace-at (cdr L) E (- N 1)))))))

(define vecinos-de
  (lambda (N G)
    (filter (lambda (a) (cond ((equal? N (cadr a)) #t)
                              (#t #f))) G)))
;; Distancias

(define distancias
  (lambda (N I) (append (repeat-e 1073741824 I) (list 0) (repeat-e 1073741824 (- N (+ I 1))))))

;;(W I)

(define insertarV
  (lambda (Q V)
    (cond ((null? V) Q)
          (#t (insertarV (insertarOrd Q (car V)) (cdr V))))))

(define insertarOrd
  (lambda (Q E Dist Prev)
    (cond ((null? Q) (list (append (list (caddr E)) (list (car E)))))
          ((< (+ (element-at Dist (cadr Prev)) (caddr E)) (caar Q)) (append (list (append (list (+ (element-at Dist (cadr Prev)) (caddr E))) (list (car E)))) Q))
          (#t (append (list (car Q)) (insertarOrd (cdr Q) E Dist Prev))))))

(define element-at
  (lambda (L N)
    (cond ((= N 0) (car L))
          (#t (element-at (cdr L) (- N 1))))))

(define remplazar-dist
  (lambda (Dist V Q)
    (cond ((null? V) Dist)
          (#t (remplazar-dist (replace-at Dist (+ (element-at Dist (cadar Q)) (caddar V)) (caar V)) (cdr V) Q)))))

(define remplazar-dist-pru
  (lambda (Dist V Prev)
    (cond ((null? V) Dist)
          (#t (remplazar-dist (replace-at Dist (+ (element-at Dist (cadr Prev)) (caddar V)) (caar V)) (cdr V) Prev)))))


(define dijkstra-aux
  (lambda (Q Dist G S D)
    (cond ((null? Q) (element-at Dist D))
          ((equal? (cdar Q) D) (element-at Dist D))
          (#t (dijkstra-aux (insertarV (cdr Q) (filter (lambda (a) (< (+ (caddr a) (element-at Dist (cadar Q))) (element-at Dist (car a)))) (vecinos-de (cadar Q) G)))
                            (remplazar-dist Dist (filter (lambda (a) (< (+ (caddr a) (element-at Dist (cadar Q))) (element-at Dist (car a)))) (vecinos-de (cadar Q) G)) Q)
                            G S D)))))

(define dijkstra-aux-pru
  (lambda (PairQD G S D)
    (cond ((null? (car PairQD)) (element-at (cadr PairQD) D))
          ((equal? (cadaar PairQD) D) (element-at (cadr PairQD) D))
          (#t (dijkstra-aux-pru (mk-pair-qd (vecinos-de (cadaar PairQD) G) (append (list (cdar PairQD)) (cdr PairQD)) (caar PairQD))
                                G S D)))))

(define dijkstra-pru
  (lambda (PairQD G S D N)
    (cond ((null? G) 1073741824)
          (#t (dijkstra-aux-pru (append (list (list (append (list 0) (list S)))) (list (distancias N S))) G S D)))))

(define mk-pair-qd
  (lambda (V PairQD Prev)
    (cond ((null? V) PairQD)
          ((< (+ (element-at (cadr PairQD) (cadr Prev)) (caddar V)) (element-at (cadr PairQD) (caar V)))
           (mk-pair-qd (cdr V)
                       (append (list (insertarOrd (car PairQD) (car V) (cadr PairQD) Prev))
                               (list (remplazar-dist-pru (cadr PairQD) (list (car V)) Prev))) Prev))
          (#t (mk-pair-qd (cdr V) PairQD Prev)))))

(define dijkstra
  (lambda (G S D N)
    (cond ((null? G) 1073741824)
          (#t (dijkstra-aux (list (append (list 0) (list S))) (distancias N S) G S D N)))))

(define print
  (lambda (V Case)
    (display "Case #")
    (display Case)
    (display ": ")
    (display (cond ((= V 1073741824) "unreachable")
                                                                    (#t V)))
    (display "\n")))

(define displayQ
  (lambda (Q)
    (cond ((null? (cdr Q)) (display "(")
                           (display (caar Q))
                           (display ",")
                           (display (cadar Q))
                           (display ") ")
                           (display "\n"))
          ((display "(")
                           (display (caar Q))
                           (display ",")
                           (display (cadar Q))
                           (display ") ")
          (displayQ (cdr Q))))))

;; ((N E S D) ())



(define tcase
  (lambda (G S D N TC)
    (print (dijkstra-pru (append (list (list (append (list 0) (list S)))) (list (distancias N S))) G S D N) TC)))

(define solve-aux
  (lambda (L TC)
    (tcase (r-edge (cadr L)) (caddar L) (cadddr (car L)) (caar L) TC)))

(define solve-x
  (lambda (L TC)
    (cond ((null? (cdr L)) (solve-aux (car L) TC))
          (#t (solve-aux (car L) TC) (solve-x (cdr L) (+ TC 1))))))

(define solve
  (lambda (L)
    (solve-x L 1)))

;;(solve '(((2 1 0 1) ((0 1 100))) ((3 3 2 0) ((0 1 100) (0 2 200) (1 2 50))) ((2 0 0 1) ()) ((100 250 36 70) ((72 40 1557) (98 37 2183) (44 59 5426) (2 67 818) (72 16 2751) (45 44 6094) (31 89 8371) (76 40 3793) (90 6 795) (32 6 9542) (48 25 1810) (3 76 1842) (59 5 3474) (92 61 7578) (1 31 1235) (51 8 1395) (90 33 2726) (30 21 9425) (86 28 2961) (46 97 7368) (62 1 4764) (52 69 8132) (76 10 6405) (51 93 3195) (63 85 2409) (37 60 8183) (24 19 4552) (11 12 7068) (64 70 3479) (38 72 5265) (52 69 4411) (16 79 4893) (74 22 3154) (23 52 5537) (91 83 1675) (69 67 2044) (25 27 9716) (97 30 1575) (33 92 8769) (44 65 7461) (64 29 7172) (22 37 9096) (18 52 5700) (58 33 7851) (66 31 2227) (31 39 8923) (90 19 2315) (97 70 4335) (37 38 9) (12 22 2760) (81 9 2287) (36 32 33) (98 46 7128) (2 95 8397) (25 33 1810) (17 9 8004) (99 98 4723) (39 73 8816) (42 8 6617) (93 86 9934) (80 22 5922) (82 34 3235) (14 73 3157) (24 87 1110) (17 47 9766) (47 65 746) (75 51 1375) (18 16 1867) (83 56 5790) (97 13 4346) (10 50 3627) (98 50 8503) (57 21 726) (37 1 3778) (86 9 6844) (63 82 8850) (27 84 5951) (8 24 6479) (42 57 1370) (22 85 6900) (25 42 1037) (5 46 2538) (43 48 2919) (68 8 376) (12 14 7195) (1 26 6900) (35 55 3827) (83 91 9139) (82 44 541) (8 91 3815) (15 63 8367) (82 16 1889) (85 7 3573) (79 87 5045) (17 84 6458) (54 67 5566) (28 84 1365) (21 30 219) (43 65 1609) (50 91 8814) (6 13 4732) (8 28 5692) (95 12 5354) (33 0 6056) (58 77 3562) (43 20 8613) (25 93 100) (32 88 7338) (75 25 6217) (89 43 9289) (72 39 6402) (41 97 7543) (19 31 3876) (59 38 3002) (51 13 1901) (15 16 9233) (11 9 6552) (56 61 517) (65 2 9039) (0 42 2703) (37 52 6469) (12 73 5448) (31 28 1529) (24 27 3464) (36 1 7) (60 63 4554) (16 42 9467) (15 79 5423) (63 32 8795) (77 89 838) (86 20 952) (40 5 7638) (33 8 6238) (71 85 3148) (7 94 8377) (99 4 567) (56 38 4992) (55 52 6635) (51 52 9807) (68 12 562) (46 2 6769) (31 65 7365) (93 88 6825) (18 9 8702) (20 27 8249) (82 79 4137) (47 64 8405) (51 50 3596) (88 5 2829) (44 31 2504) (74 30 6621) (69 97 5754) (80 24 5785) (39 49 9177) (9 74 6145) (89 49 1399) (65 18 9644) (23 85 8528) (48 81 7125) (62 81 7330) (11 21 1687) (57 53 5324) (20 16 1664) (67 26 4112) (59 18 407) (79 67 2958) (56 61 3434) (96 44 3763) (96 11 969) (21 31 1515) (41 44 7083) (43 8 3806) (73 32 3607) (89 43 1923) (68 72 1457) (28 68 86) (96 34 4985) (92 51 3976) (15 28 9181) (47 11 7105) (23 44 1905) (21 18 6012) (98 53 1104) (83 45 369) (3 26 1879) (40 25 3410) (85 76 925) (77 91 195) (86 31 378) (46 71 3171) (20 18 2224) (60 14 4119) (73 43 4401) (61 17 5172) (39 64 5089) (28 89 7753) (58 97 3633) (60 87 6702) (70 18 8229) (80 64 9962) (58 26 7801) (91 10 7703) (34 6 7570) (22 50 289) (21 51 8301) (85 79 4787) (80 88 5935) (1 24 9827) (64 68 6288) (29 89 2097) (37 98 3338) (85 24 4095) (0 37 8984) (57 3 7739) (4 62 1846) (17 55 827) (51 99 3994) (74 56 4258) (76 79 2415) (95 98 596) (16 78 8305) (19 71 4658) (70 28 9131) (2 21 9330) (90 87 272) (22 45 2658) (62 65 2310) (28 2 7902) (67 57 7215) (95 66 3346) (8 87 8682) (3 21 5501) (81 68 4384) (11 27 4863) (41 63 2187) (25 33 9413) (74 85 1525) (45 5 4506) (22 30 5991) (74 78 2163) (29 51 6217) (54 42 1772) (28 61 6006) (98 88 5207) (15 30 2982) (23 77 8846) (42 22 2487) (30 35 1669) (71 6 1309) (0 34 1987))) ((6 3 0 2) ((0 1 50) (2 1 70) (0 2 150))) ((2 1 0 1) ((1 0 10000))) ((2 1 0 1) ((1 0 111))) ((2 2 0 1) ((1 0 100) (0 1 33))) ((2 1 0 1) ((0 1 100))) ((3 3 2 0) ((0 1 100) (0 2 200) (1 2 50))) ((2 0 0 1) ()) ((14 20 13 2) ((0 1 123) (1 2 467) (2 3 478) (4 5 578) (5 3 47) (2 6 256) (7 2 246) (5 9 245) (5 3 1245) (8 2 575) (9 4 235) (2 8 437) (9 12 367) (13 7 587) (11 9 476) (9 5 34) (11 13 35) (13 10 2) (12 11 7) (12 6 235))) ((14 16 11 2) ((0 1 123) (1 2 467) (2 3 478) (4 5 578) (5 3 47) (2 6 256) (7 2 246) (5 9 245) (5 3 1245) (9 4 235) (9 12 367) (13 7 587) (11 9 476) (9 5 34) (13 11 2) (12 11 7))) ((4 5 0 3) ((0 2 17) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((4 7 0 3) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((4 7 2 1) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((6 7 0 4) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((14 20 13 2) ((0 1 123) (1 2 4567) (2 3 4578) (4 5 5678) (5 3 47) (2 6 256) (7 2 2346) (5 9 2345) (5 3 12345) (8 2 5785) (9 4 2345) (2 8 4367) (9 12 3467) (13 7 5687) (11 9 4576) (9 5 34) (11 13 345) (13 11 2) (12 11 7) (12 6 235898))) ((14 20 13 2) ((0 1 123) (1 2 467) (2 3 478) (4 5 578) (5 3 47) (2 6 256) (7 2 246) (5 9 245) (5 3 1245) (8 2 575) (9 4 235) (2 8 437) (9 12 367) (13 7 587) (11 9 476) (9 5 34) (11 13 35) (13 10 2) (12 11 7) (12 6 235))) ((14 16 11 2) ((0 1 123) (1 2 467) (2 3 478) (4 5 578) (5 3 47) (2 6 256) (7 2 246) (5 9 245) (5 3 1245) (9 4 235) (9 12 367) (13 7 587) (11 9 476) (9 5 34) (13 11 2) (12 11 7))) ((6 7 0 4) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((4 3 0 3) ((2 0 50) (1 2 70) (3 1 150))) ((2 1 0 1) ((0 1 110))) ((3 3 2 0) ((0 1 100) (0 2 20) (1 2 50))) ((4 3 0 3) ((2 0 50) (1 2 7) (3 1 150))) ((2 1 0 1) ((0 1 10))) ((3 3 2 0) ((0 1 10) (0 2 202) (1 2 52))) ((4 3 1 0) ((1 2 104) (2 3 204) (0 3 541))) ((6 7 3 0) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((6 7 0 2) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((6 7 0 1) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((6 7 0 0) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((6 7 1 2) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((6 7 2 3) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((5 5 0 4) ((0 1 3) (1 0 2) (1 0 1) (0 1 4) (1 4 1000))) ((85 250 7 42) ((81 66 9528) (15 36 6205) (9 32 2281) (60 17 7405) (39 72 1320) (67 9 3112) (75 20 2732) (20 46 6013) (64 30 2476) (36 24 3652) (16 58 962) (19 45 390) (0 71 8816) (73 14 7879) (47 12 4457) (27 49 5598) (28 17 4430) (80 11 6597) (66 38 1410) (20 75 7915) (43 68 5516) (24 51 803) (70 58 7339) (31 40 6007) (30 22 3102) (43 15 3631) (72 12 6934) (3 14 5459) (5 40 8889) (28 49 1688) (33 74 9748) (3 38 5456) (29 68 9530) (81 67 4096) (78 0 1521) (14 9 2526) (48 31 9537) (45 53 167) (32 24 7820) (74 3 7996) (49 71 2171) (37 41 9729) (72 12 6472) (36 1 4728) (59 27 8517) (33 8 6225) (36 0 7206) (55 44 4025) (33 12 7677) (41 36 8287) (10 30 9614) (79 70 617) (8 7 2599) (18 55 2458) (10 61 4888) (20 66 1090) (34 0 5936) (12 27 4036) (38 3 9482) (79 22 3032) (56 59 4246) (11 50 435) (69 49 5708) (75 7 8126) (62 14 9039) (78 62 1683) (81 79 1671) (27 70 4119) (11 84 8887) (73 17 3501) (7 16 9610) (75 32 610) (55 81 696) (25 80 6762) (14 34 1204) (26 64 4863) (62 26 3730) (8 41 9616) (35 70 9773) (25 32 9594) (7 5 1680) (4 9 6696) (45 4 1543) (26 76 10) (17 76 9826) (10 76 5123) (35 23 161) (40 64 3985) (56 45 2970) (12 37 433) (71 75 6211) (80 6 8561) (23 2 773) (51 75 3013) (39 40 792) (55 53 2238) (54 43 5555) (78 22 2177) (4 23 4935) (74 69 2401) (2 19 1911) (7 47 2116) (25 60 7943) (67 49 3896) (65 42 71) (31 54 266) (13 1 691) (10 7 6697) (70 23 6571) (50 7 5264) (4 8 376) (12 8 3929) (11 46 2029) (54 20 4213) (30 57 3398) (68 80 2252) (0 70 2399) (49 19 8790) (11 62 6037) (39 33 2475) (33 68 326) (50 23 6971) (66 69 9199) (82 55 3508) (38 33 1827) (40 62 8425) (71 69 6139) (53 77 951) (12 13 58) (46 2 3516) (35 41 1156) (9 64 845) (51 2 321) (51 3 2130) (14 27 961) (58 46 1463) (38 28 3540) (40 27 3891) (63 47 4809) (43 68 7061) (77 47 3429) (23 49 6205) (57 23 4839) (77 45 177) (6 7 227) (68 34 8988) (84 64 4618) (1 66 821) (48 60 36) (29 35 3993) (38 19 527) (58 6 3774) (63 15 2199) (57 1 7930) (0 16 4733) (74 15 3266) (45 57 7164) (58 64 8334) (36 4 4382) (42 22 6080) (7 5 3614) (19 16 9921) (8 17 1286) (36 28 8835) (70 82 1181) (47 54 4959) (41 38 3428) (12 50 4833) (14 34 8415) (66 12 686) (2 34 5562) (83 4 7810) (62 15 2794) (52 29 3833) (23 46 6561) (55 30 3628) (55 8 3130) (81 24 8172) (74 21 1170) (65 39 6177) (52 68 665) (39 11 4335) (49 46 839) (1 33 4321) (44 81 9076) (56 37 7406) (77 10 6262) (56 39 3418) (55 56 3082) (24 84 6517) (23 9 6584) (75 27 8437) (11 20 5668) (49 27 7852) (41 79 1758) (64 5 8336) (84 44 5597) (32 17 379) (53 48 2391) (79 4 6377) (84 48 3497) (66 33 6362) (82 44 3563) (3 55 8142) (49 66 2265) (73 70 1884) (1 77 3773) (4 26 9416) (50 20 3248) (52 60 3537) (50 35 2506) (69 74 2696) (65 81 120) (2 42 4124) (2 38 7808) (38 14 1310) (38 61 2975) (47 67 1414) (74 75 9879) (69 73 9672) (45 21 4135) (40 20 469) (41 57 8916) (66 2 1243) (25 74 2446) (52 69 5897) (69 12 1091) (37 29 803) (38 33 4364) (25 13 2874) (82 26 2762) (45 43 5333) (4 33 4142) (27 71 2634) (12 13 2173) (63 70 6955) (21 54 9085) (8 54 7034) (60 41 218) (6 61 3301) (71 58 7784) (28 35 750) (84 47 734) (2 63 9910) (7 49 3631) (70 40 6082) (60 35 902) (35 30 8099) (25 4 7830) (53 11 964))) ((6 9 3 2) ((0 1 4) (0 2 2) (1 2 1) (1 3 5) (2 3 8) (2 4 10) (3 4 2) (3 5 6) (4 5 3))) ((8 7 0 7) ((4 3 40) (2 3 505) (1 2 606) (0 1 30) (4 5 100) (5 6 201) (6 7 707))) ((8 7 0 7) ((0 1 404) (1 2 505) (2 3 606) (3 4 303) (4 5 10) (5 6 201) (6 7 707))) ((8 7 0 7) ((0 1 404) (3 2 50) (2 1 606) (5 6 303) (4 5 100) (3 4 201) (6 7 707))) ((8 7 0 7) ((4 3 404) (4 5 505) (5 6 606) (3 2 303) (2 1 10) (6 7 201) (0 1 707))) ((8 7 0 7) ((1 2 404) (6 7 505) (3 4 602) (0 1 303) (5 4 103) (5 6 201) (3 2 707))) ((6 9 4 3) ((0 1 4) (0 2 2) (1 2 1) (1 3 5) (2 3 8) (2 4 10) (3 4 2) (3 5 6) (4 5 3))) ((6 9 5 5) ((0 1 4) (0 2 2) (1 2 1) (1 3 5) (2 3 8) (2 4 10) (3 4 2) (3 5 6) (4 5 3))) ((6 13 0 5) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4) (0 2 7) (1 0 1) (0 3 8) (2 3 1) (2 1 2) (5 3 100))) ((6 13 1 5) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4) (0 2 7) (1 0 1) (0 3 8) (2 3 1) (2 1 2) (5 3 100))) ((6 13 2 5) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4) (0 2 7) (1 0 1) (0 3 8) (2 3 1) (2 1 2) (5 3 100))) ((6 13 3 4) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4) (0 2 7) (1 0 1) (0 3 8) (2 3 1) (2 1 2) (5 3 100))) ((6 13 2 5) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4) (0 2 7) (1 0 1) (0 3 8) (2 3 1) (2 1 2) (5 3 100))) ((6 9 0 5) ((0 1 4) (0 2 2) (1 2 1) (1 3 5) (2 3 8) (2 4 10) (3 4 2) (3 5 6) (4 5 3))) ((43 172 36 2) ((11 8 7449) (0 4 7118) (29 5 6652) (5 10 5583) (33 0 5513) (5 36 5377) (39 30 8037) (36 12 1719) (7 21 6822) (20 22 600) (40 29 9167) (17 4 4481) (16 13 2072) (17 39 9737) (35 40 5465) (4 2 3128) (29 27 735) (9 17 5066) (42 8 4707) (21 5 7362) (13 16 3963) (40 17 9138) (28 3 6523) (29 28 4320) (28 19 273) (1 40 651) (41 0 5715) (11 10 846) (28 11 5306) (1 33 5292) (42 15 9503) (42 29 9996) (36 16 9444) (7 22 7810) (18 25 682) (12 41 8621) (16 37 7456) (31 8 141) (27 39 2986) (41 23 7572) (38 4 4888) (20 12 6602) (33 29 8455) (0 36 188) (37 10 3888) (17 26 9931) (42 1 628) (27 25 3292) (21 1 370) (18 1 8760) (18 31 1603) (27 9 3703) (40 15 647) (29 2 1511) (15 39 746) (6 18 3613) (25 42 8106) (21 26 633) (5 36 9329) (2 22 2754) (8 36 114) (9 21 1365) (18 37 4151) (22 0 1391) (6 39 7396) (26 35 2752) (17 42 4595) (23 28 436) (18 6 2315) (21 35 3302) (34 32 6914) (24 1 985) (26 11 8759) (17 26 7448) (6 4 1518) (42 0 9338) (18 2 690) (39 12 994) (24 4 9172) (12 18 8983) (40 24 8232) (5 19 1937) (23 38 3555) (28 41 9844) (38 26 472) (20 27 7134) (10 30 4421) (10 7 6258) (28 24 9395) (36 27 1027) (31 38 6661) (22 2 2532) (37 10 2645) (19 6 9036) (29 1 8234) (23 2 9001) (16 9 5874) (28 9 3914) (17 26 6323) (30 25 9141) (14 40 514) (22 7 49) (32 10 5733) (37 15 2380) (17 15 3665) (27 7 5079) (2 16 7193) (6 27 3152) (39 41 1860) (34 27 5467) (30 15 4032) (34 35 2531) (29 7 2478) (19 25 4809) (37 26 6617) (31 1 1717) (37 27 924) (30 11 2126) (12 27 2372) (23 35 1171) (9 23 727) (28 6 9993) (24 12 8633) (6 33 6139) (25 14 2590) (18 14 8690) (19 3 7225) (24 0 4720) (3 34 7177) (1 4 7297) (35 41 2917) (34 27 7512) (1 6 4906) (7 28 6201) (8 29 4441) (34 40 8166) (11 21 6478) (14 7 5984) (26 24 811) (9 5 932) (22 4 8047) (10 27 7613) (35 4 8724) (38 3 6849) (37 1 2832) (1 42 5450) (0 31 1393) (40 16 9975) (35 2 557) (35 36 8245) (3 25 1202) (41 3 8517) (37 25 4776) (28 23 1763) (4 11 1220) (3 34 2909) (20 3 9917) (18 24 6910) (0 2 918) (11 16 3302) (35 12 2152) (41 1 3401) (23 4 7545) (21 23 8146) (17 14 2506) (4 31 4976) (20 24 9540) (12 25 1199) (19 39 1850) (35 39 439) (22 3 1765) (27 12 2048))) ((6 9 4 3) ((0 1 4) (0 2 2) (1 2 1) (1 3 1) (2 3 8) (2 4 10) (3 4 2) (3 5 6) (4 5 3))) ((6 9 5 5) ((0 1 4) (0 2 2) (1 2 12) (1 3 5) (2 3 8) (2 4 10) (3 4 2) (3 5 6) (4 5 3))) ((6 13 0 5) ((0 1 14) (0 2 17) (1 0 11) (0 3 1) (2 3 11) (2 1 2) (0 1 4) (0 2 7) (1 0 1) (0 3 8) (2 3 1) (2 1 2) (5 3 100))) ((6 13 1 5) ((0 1 14) (0 2 17) (1 0 1) (0 3 18) (2 3 11) (2 1 2) (0 1 4) (0 2 7) (1 0 1) (0 3 8) (2 3 1) (2 1 2) (5 3 100))) ((6 9 3 0) ((0 1 4) (0 2 2) (1 2 1) (1 3 5) (2 3 8) (2 4 10) (3 4 2) (3 5 6) (4 5 3))) ((8 7 4 6) ((3 2 404) (2 1 505) (1 0 606) (0 4 303) (4 5 100) (5 6 201) (6 7 707))) ((1 1 0 0) ((0 0 25))) ((5 4 0 4) ((1 2 404) (3 4 505) (3 2 606) (1 0 100))) ((6 7 5 0) ((2 3 404) (4 5 505) (3 5 606) (4 3 303) (1 2 100) (0 4 201) (1 5 707))) ((4 3 0 2) ((0 1 50) (2 1 70) (0 2 150))) ((4 3 1 2) ((0 1 50) (2 1 70) (0 2 150))) ((38 250 25 2) ((20 32 3255) (8 16 1377) (27 24 6130) (28 5 3257) (25 20 6571) (9 24 4804) (17 22 3642) (1 24 2861) (0 34 8390) (27 6 375) (30 8 5061) (16 5 7215) (14 25 2477) (12 11 2048) (2 30 652) (25 3 255) (28 8 939) (30 21 2644) (4 25 6485) (9 31 6198) (1 19 2198) (9 25 8949) (3 35 8725) (12 2 5579) (29 36 2772) (10 34 5066) (36 27 2261) (28 36 2315) (36 9 1420) (23 2 1943) (9 28 2811) (24 17 2129) (9 7 1321) (6 13 1602) (14 26 5034) (22 26 2303) (25 12 3325) (19 26 4240) (21 23 9187) (20 18 7325) (36 32 7407) (22 7 6474) (13 28 2717) (29 12 2113) (7 19 5598) (37 29 203) (21 4 9308) (37 18 3157) (13 26 2890) (20 29 4202) (21 33 686) (31 9 2172) (18 37 2138) (33 31 2761) (4 28 2804) (33 10 3731) (3 32 2003) (18 28 4819) (15 11 320) (3 7 2415) (0 33 7553) (21 16 6984) (30 22 1379) (22 27 3391) (15 33 4810) (2 29 2716) (34 14 6111) (7 34 3251) (7 11 4835) (36 25 7050) (33 17 2854) (9 20 5668) (24 2 2559) (29 0 5118) (13 9 1271) (21 14 522) (27 11 4197) (8 2 4605) (10 37 5319) (20 24 1194) (21 12 4013) (3 9 2120) (36 14 1915) (9 3 804) (28 2 3871) (5 1 6916) (2 36 4593) (25 17 1280) (22 18 9527) (22 25 5663) (14 8 7692) (2 33 7815) (5 22 3711) (25 28 1045) (15 4 9868) (1 21 1197) (10 36 3376) (32 25 7441) (22 7 5994) (21 10 3496) (34 9 7547) (35 12 2003) (1 8 6632) (15 36 622) (14 21 1857) (37 8 5458) (1 31 1630) (17 16 5129) (14 16 9405) (37 18 6034) (27 14 6788) (30 34 3856) (24 33 4862) (13 18 8515) (18 3 9733) (23 33 2055) (34 14 207) (19 20 9700) (19 26 6061) (7 23 4777) (17 35 2818) (26 20 7135) (29 25 846) (4 8 8223) (36 31 8361) (8 17 2008) (6 34 598) (12 16 5250) (34 6 1334) (35 19 9191) (28 16 2133) (27 24 5306) (24 20 5674) (16 35 52) (8 37 2587) (36 28 1460) (29 34 5586) (30 32 5102) (2 19 5662) (14 2 7544) (21 20 6379) (23 35 9327) (36 0 3130) (19 20 7586) (35 32 6522) (35 28 4725) (7 5 5954) (15 32 5901) (33 18 4756) (22 17 97) (27 21 127) (17 14 8874) (23 32 231) (31 30 1221) (15 7 7241) (1 15 8447) (26 31 1877) (13 28 4732) (35 25 716) (8 7 5425) (7 14 1423) (2 1 2040) (33 4 1010) (25 37 7125) (27 22 7339) (26 3 441) (25 3 1770) (30 2 9170) (18 25 7920) (18 20 8387) (14 35 8544) (12 5 6602) (11 30 6539) (21 29 6962) (22 16 9910) (15 17 5614) (31 14 2207) (29 12 67) (20 13 4335) (9 19 6149) (33 29 2252) (22 24 47) (9 10 2393) (13 29 9045) (8 36 6458) (32 21 7624) (29 25 7875) (23 15 6037) (26 9 8399) (11 5 761) (23 22 202) (22 34 8637) (9 37 3325) (12 20 3668) (5 19 8675) (0 22 2082) (2 18 9806) (8 5 978) (23 25 1186) (30 33 3556) (25 33 9162) (12 20 6610) (9 11 4538) (20 4 8113) (25 24 8641) (6 0 3635) (25 18 688) (12 17 3848) (8 34 9177) (26 29 9545) (8 7 2009) (36 33 9116) (19 21 9603) (16 9 7070) (24 0 2883) (1 13 2669) (10 0 9906) (26 18 2814) (12 34 2834) (10 23 838) (30 22 8363) (24 16 47) (30 27 8532) (22 2 903) (19 27 9801) (25 4 9379) (9 5 2604) (0 6 1777) (10 28 5597) (17 34 1536) (33 15 5573) (15 23 2048) (34 2 2646) (20 24 1104) (36 13 7111) (27 30 8607) (34 1 1915) (0 8 7326) (2 0 1246) (15 4 1198) (24 22 9758) (22 37 1263) (37 17 5770) (22 3 4249) (15 23 2846) (36 2 2879) (23 32 7461) (18 23 1307) (15 22 941) (5 25 9011))) ((6 9 0 5) ((0 1 4) (0 2 2) (1 2 1) (1 3 5) (2 3 8) (2 4 10) (3 4 2) (3 5 6) (4 5 3))) ((16 70 3 1) ((15 2 5107) (3 6 1255) (10 11 4168) (6 11 4584) (4 5 4101) (0 13 1529) (11 14 176) (12 13 2776) (7 0 7556) (7 14 9427) (10 5 2834) (3 15 8387) (5 3 2444) (15 5 7260) (3 7 5309) (13 15 3729) (0 5 5388) (15 13 7991) (11 4 7909) (7 0 1426) (13 7 1397) (13 14 1692) (1 5 2105) (15 2 8408) (0 4 3994) (2 15 2878) (3 9 2537) (6 11 2009) (13 3 578) (0 1 6795) (7 9 1439) (3 13 2777) (9 1 1105) (6 0 719) (5 0 6474) (9 14 7265) (9 15 79) (4 6 7801) (4 11 7221) (6 4 7516) (14 11 8584) (12 2 1279) (1 15 8822) (13 4 6829) (15 14 8693) (10 11 4575) (1 0 9857) (4 12 2061) (9 7 1292) (5 14 2039) (8 15 2016) (0 15 5490) (4 6 6664) (6 15 131) (10 4 1666) (15 0 3088) (8 12 2089) (8 15 1682) (2 13 7834) (7 2 8383) (15 1 4951) (1 10 6816) (0 6 2497) (13 15 4310) (12 6 1115) (1 4 4921) (8 9 7065) (9 6 4337) (11 12 1782) (9 3 3583))) ((6 9 3 0) ((0 1 4) (0 2 2) (1 2 1) (1 3 5) (2 3 8) (2 4 10) (3 4 2) (3 5 6) (4 5 3))) ((8 7 4 6) ((3 2 404) (2 1 505) (1 0 606) (0 4 303) (4 5 100) (5 6 201) (6 7 707))) ((8 7 6 4) ((3 2 404) (2 1 505) (1 0 606) (0 4 303) (4 5 100) (5 6 201) (6 7 707))) ((8 7 2 5) ((3 2 404) (2 1 505) (1 0 606) (0 4 303) (4 5 100) (5 6 201) (6 7 707))) ((8 7 2 6) ((3 2 404) (2 1 505) (1 0 606) (0 4 303) (4 5 100) (5 6 201) (6 7 707))) ((8 7 2 7) ((3 2 404) (2 1 505) (1 0 606) (0 4 303) (4 5 100) (5 6 201) (6 7 707))) ((8 7 3 7) ((3 2 404) (2 1 505) (1 0 606) (0 4 303) (4 5 100) (5 6 201) (6 7 707))) ((8 7 0 7) ((4 3 404) (2 3 505) (1 2 606) (0 1 303) (4 5 100) (5 6 201) (6 7 707))) ((8 7 0 7) ((0 1 404) (1 2 505) (2 3 606) (3 4 303) (4 5 100) (5 6 201) (6 7 707))) ((8 7 0 7) ((0 1 404) (3 2 505) (2 1 606) (5 6 303) (4 5 100) (3 4 201) (6 7 707))) ((8 7 0 7) ((4 3 404) (4 5 505) (5 6 606) (3 2 303) (2 1 100) (6 7 201) (0 1 707))) ((8 7 0 7) ((1 2 404) (6 7 505) (3 4 606) (0 1 303) (5 4 100) (5 6 201) (3 2 707))) ((8 7 3 7) ((3 2 404) (2 1 505) (1 0 606) (0 4 303) (4 5 100) (5 6 201) (6 7 707))) ((8 7 3 7) ((2 3 404) (1 2 505) (0 1 606) (4 0 303) (5 4 100) (6 5 201) (6 7 707))) ((1 1 0 0) ((0 0 25))) ((5 4 0 4) ((1 2 404) (3 4 505) (3 2 606) (1 0 100))) ((6 7 0 5) ((2 3 404) (4 5 505) (3 5 606) (4 3 303) (1 2 100) (0 4 201) (1 5 707))) ((6 3 0 2) ((0 1 50) (2 1 70) (0 2 150))) ((2 1 0 1) ((1 0 10000))) ((6 7 3 0) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((6 7 0 2) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 22) (0 1 4))) ((6 7 0 1) ((0 1 14) (0 2 171) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((6 7 0 0) ((0 1 14) (0 2 17) (1 0 11) (0 3 18) (2 3 11) (2 1 23) (0 1 4))) ((6 7 1 2) ((0 1 14) (0 2 12) (1 0 11) (0 3 18) (2 3 11) (2 1 2) (0 1 4))) ((6 7 2 3) ((0 1 14) (0 2 17) (1 0 11) (0 3 11) (2 3 11) (2 1 2) (0 1 4))) ((2 1 0 1) ((0 1 103))) ((2 0 0 1) ()) ((2 0 1 0) ()) ((4 3 0 3) ((2 0 50) (1 2 70) (3 1 150))) ((2 1 0 1) ((0 1 100))) ((3 3 2 0) ((0 1 100) (0 2 200) (1 2 50))) ((4 3 0 3) ((2 0 50) (1 2 70) (3 1 150))) ((2 1 0 1) ((0 1 100))) ((3 3 2 0) ((0 1 102) (0 2 202) (1 2 52))) ((4 3 1 0) ((1 2 104) (2 3 204) (0 3 54)))))

;; (print (dijkstra '((0 1 4) (1 0 4) (0 2 2) (2 0 2) (1 2 1) (2 1 1) (1 3 5) (3 1 5) (2 3 8) (3 2 8) (2 4 10) (4 2 10) (3 4 2) (4 3 2) (3 5 6) (5 3 6) (4 5 3) (5 4 3)) 5 2 6) 1)
;; (print (dijkstra (r-edge '((0 1 50) (2 1 70) (0 2 150))) 0 2 6) 1)
;; (print (dijkstra (r-edge '((1 0 10000))) 0 1 2) 1)
;; (print (dijkstra '((0 1 100) (1 0 100)) 0 2 3) 1)
;; (print (dijkstra '((0 1 100) (0 2 200) (1 0 100) (1 2 50) (2 0 200) (2 1 50)) 2 0 3) 1)
;; (print (dijkstra '() 0 1 2) 1)
;; (print (dijkstra (r-edge '((0 1 123) (1 2 467) (2 3 478) (4 5 578) (5 3 47) (2 6 256) (7 2 246) (5 9 245) (5 3 1245) (8 2 575) (9 4 235) (2 8 437) (9 12 367) (13 7 587) (11 9 476) (9 5 34) (11 13 35) (13 10 2) (12 11 7) (12 6 235))) 13 2 14) 1)